<!doctype html>
<html lang="it">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Monster Collection</title>
    <link rel="icon" type="image/png" sizes="32x32" href="static/favicon-32x32.png">
    <link rel="stylesheet" href="static/style.css">
    <link rel="manifest" href="manifest.json">
    <script src="static/script.js"></script>
</head>

<body class="bg-secondary">
    <div class="container">

        <h1 class="fw-light text-center my-5">Monster Collection</h1>

        <div class="container text-center">
            <div class="row g-2" id="row"></div>
        </div>
    </div>

    <footer >
        <div class="site-footer">
            <p id="stat">....</p>
            <p>© 2024 Enzo Monster Collection...</p>
        </div>
    </footer>


    <script>

        var count = 0;
        var value = 0;
//${car.image}
        can.forEach(function (car) {
            var fragment = `
                            <div class="card">
                                <img src="images/waiting.webp" class="card-img-top" alt="..." id="${car.image}">
                                <div class="card-body">
                                    <h5 class="card-text">${car.title}</h5>
                                </div>
                            </div>
                        `;

            var iDiv = document.createElement('div');
            iDiv.id = car.name;
            iDiv.className = 'col my-3';
            iDiv.innerHTML = fragment;

            document.getElementById('row').appendChild(iDiv);

            var img = document.getElementById(car.image);
            var imgPreload = new Image();
            imgPreload.onload = function() {
                img.src = `images/`+car.image; // Cambia il src quando l'immagine è carica
                console.log(car.image);
            };
            imgPreload.src = `images/`+car.image;



            count += 1;
            value += Number(car.value);
        });

        document.getElementById("stat").innerHTML = `Statistiche: ${count} Pezzi : ${value} Valore`;


        /* SERVICE WORK */
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                navigator.serviceWorker.register('/sw.js').then(function (registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function (err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>

</html>